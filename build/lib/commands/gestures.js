"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _support = require("@appium/support");

var _baseDriver = require("@appium/base-driver");

var _xpath = _interopRequireDefault(require("xpath.js"));

var _xmldom = require("xmldom");

var _privateapis = _interopRequireDefault(require("@stdspa/stdspalinux_temp/dist/privateapis"));

var _utils = require("../utils");

const commands = {};

function extractUuid(options = {}, keyNames = ['element-6066-11e4-a52e-4f735466cecf', 'element']) {
  for (const name of keyNames) {
    if (options[name]) {
      const result = _support.util.unwrapElement(options[name]);

      if (result) {
        return result;
      }
    }
  }

  return null;
}

function requireUuid(options = {}, keyNames = ['element-6066-11e4-a52e-4f735466cecf', 'element']) {
  const result = extractUuid(options, keyNames);

  if (!result) {
    throw new _baseDriver.errors.InvalidArgumentError(`${keyNames[0]} field is mandatory`);
  }

  return result;
}

commands._findElRect = function (uuid) {
  var _attrs$find;

  const strEl = this._cache.get(uuid);

  const doc = new _xmldom.DOMParser().parseFromString(strEl);

  if (!doc.attributes) {
    throw new _baseDriver.errors.UnknownError("the element has no rect attribute");
  }

  const attrs = Array.from(doc.attributes);
  const rect = (_attrs$find = attrs.find(p => p.name = 'rect')) === null || _attrs$find === void 0 ? void 0 : _attrs$find.value;

  if (!rect) {
    throw new _baseDriver.errors.UnknownError("the element has no rect attribute");
  }

  const mat = /^\[(?<x>\d+)\,(?<y>\d+)\,(?<width>\d+)\,(?<height>\d+)\]$/.exec(rect);

  if (!mat) {
    throw new _baseDriver.errors.UnknownError("the element's rect attribute is malformed");
  }

  const {
    x,
    y,
    width,
    height
  } = mat.groups;
  return {
    x: Number.parseInt(x),
    y: Number.parseInt(y),
    width: Number.parseInt(width),
    height: Number.parseInt(height)
  };
};

commands.setValue = commands.replaceValue = commands.setValueImmediate = async function setValue(opts = {}) {
  const uuid = requireUuid(opts);
  const {
    value,
    text
  } = opts;

  const _v = _support.util.hasValue(value) ? value : _support.util.hasValue(text) ? text : null;

  const {
    x,
    y,
    width,
    height
  } = this._findElRect(uuid);

  const _x = x + width / 2;

  const _y = y + height / 2;

  await (0, _utils.wait4sec)(0.5);

  _privateapis.default.mouse_click(_x, _y, 1);

  await (0, _utils.wait4sec)(0.5);

  _privateapis.default.keyboard_typeStringCopyPaste(_v);

  return null;
};

commands.click = async function click(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  return null;
};

commands.scroll = async function scroll(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    deltaX,
    deltaY,
    keyModifierFlags
  } = opts;
  return null;
};

commands.swipe = async function swipe(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    direction,
    velocity,
    keyModifierFlags
  } = opts;
  return null;
};

commands.rightClick = async function rightClick(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  return null;
};

commands.hover = async function hover(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  return null;
};

commands.doubleClick = async function doubleClick(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  return null;
};

commands.keys = async function keys(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    keys
  } = opts;
  return null;
};

commands.pressKeyCode = async function pressKeyCode(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    keycode,
    flags
  } = opts;
  return null;
};

commands.longPressKeyCode = async function longPressKeyCode(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    keycode,
    flags
  } = opts;
  return null;
};

var _default = commands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9nZXN0dXJlcy5qcyJdLCJuYW1lcyI6WyJjb21tYW5kcyIsImV4dHJhY3RVdWlkIiwib3B0aW9ucyIsImtleU5hbWVzIiwibmFtZSIsInJlc3VsdCIsInV0aWwiLCJ1bndyYXBFbGVtZW50IiwicmVxdWlyZVV1aWQiLCJlcnJvcnMiLCJJbnZhbGlkQXJndW1lbnRFcnJvciIsIl9maW5kRWxSZWN0IiwidXVpZCIsInN0ckVsIiwiX2NhY2hlIiwiZ2V0IiwiZG9jIiwiZG9tIiwicGFyc2VGcm9tU3RyaW5nIiwiYXR0cmlidXRlcyIsIlVua25vd25FcnJvciIsImF0dHJzIiwiQXJyYXkiLCJmcm9tIiwicmVjdCIsImZpbmQiLCJwIiwidmFsdWUiLCJtYXQiLCJleGVjIiwieCIsInkiLCJ3aWR0aCIsImhlaWdodCIsImdyb3VwcyIsIk51bWJlciIsInBhcnNlSW50Iiwic2V0VmFsdWUiLCJyZXBsYWNlVmFsdWUiLCJzZXRWYWx1ZUltbWVkaWF0ZSIsIm9wdHMiLCJ0ZXh0IiwiX3YiLCJoYXNWYWx1ZSIsIl94IiwiX3kiLCJhcGlzIiwibW91c2VfY2xpY2siLCJrZXlib2FyZF90eXBlU3RyaW5nQ29weVBhc3RlIiwiY2xpY2siLCJrZXlNb2RpZmllckZsYWdzIiwic2Nyb2xsIiwiZGVsdGFYIiwiZGVsdGFZIiwic3dpcGUiLCJkaXJlY3Rpb24iLCJ2ZWxvY2l0eSIsInJpZ2h0Q2xpY2siLCJob3ZlciIsImRvdWJsZUNsaWNrIiwia2V5cyIsInByZXNzS2V5Q29kZSIsImtleWNvZGUiLCJmbGFncyIsImxvbmdQcmVzc0tleUNvZGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsUUFBUSxHQUFHLEVBQWpCOztBQUVBLFNBQVNDLFdBQVQsQ0FBc0JDLE9BQU8sR0FBRyxFQUFoQyxFQUFvQ0MsUUFBUSxHQUFHLENBQUMscUNBQUQsRUFBd0MsU0FBeEMsQ0FBL0Ms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QUFPLElBQVA7QUFDRCxDQUpEOztBQU1BeEMsUUFBUSxDQUFDNEQsSUFBVCxHQUFnQixlQUFlQSxJQUFmLENBQXFCcEIsSUFBSSxHQUFHLEVBQTVCLEVBQWdDO0FBQzlDLFFBQU01QixJQUFJLEdBQUdYLFdBQVcsQ0FBQ3VDLElBQUQsQ0FBeEI7QUFDQSxRQUFNO0FBQUVvQixJQUFBQTtBQUFGLE1BQVdwQixJQUFqQjtBQUNBLFNBQU8sSUFBUDtBQUNELENBSkQ7O0FBTUF4QyxRQUFRLENBQUM2RCxZQUFULEdBQXdCLGVBQWVBLFlBQWYsQ0FBNkJyQixJQUFJLEdBQUcsRUFBcEMsRUFBd0M7QUFDOUQsUUFBTTVCLElBQUksR0FBR1gsV0FBVyxDQUFDdUMsSUFBRCxDQUF4QjtBQUNBLFFBQU07QUFBRXNCLElBQUFBLE9BQUY7QUFBV0MsSUFBQUE7QUFBWCxNQUFxQnZCLElBQTNCO0FBQ0EsU0FBTyxJQUFQO0FBQ0QsQ0FKRDs7QUFNQXhDLFFBQVEsQ0FBQ2dFLGdCQUFULEdBQTRCLGVBQWVBLGdCQUFmLENBQWlDeEIsSUFBSSxHQUFHLEVBQXhDLEVBQTRDO0FBQ3RFLFFBQU01QixJQUFJLEdBQUdYLFdBQVcsQ0FBQ3VDLElBQUQsQ0FBeEI7QUFDQSxRQUFNO0FBQUVzQixJQUFBQSxPQUFGO0FBQVdDLElBQUFBO0FBQVgsTUFBcUJ2QixJQUEzQjtBQUNBLFNBQU8sSUFBUDtBQUNELENBSkQ7O2VBTWV4QyxRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXRpbCB9IGZyb20gJ0BhcHBpdW0vc3VwcG9ydCc7XG5pbXBvcnQgeyBlcnJvcnMgfSBmcm9tICdAYXBwaXVtL2Jhc2UtZHJpdmVyJztcbmltcG9ydCBzZWxlY3QgZnJvbSAneHBhdGguanMnO1xuaW1wb3J0IHsgRE9NUGFyc2VyIGFzIGRvbSB9IGZyb20gJ3htbGRvbSc7XG5pbXBvcnQgYXBpcyBmcm9tICdAc3Rkc3BhL3N0ZHNwYWxpbnV4X3RlbXAvZGlzdC9wcml2YXRlYXBpcyc7XG5pbXBvcnQgeyB3YWl0NHNlYyB9IGZyb20gJy4uL3V0aWxzJztcblxuY29uc3QgY29tbWFuZHMgPSB7fTtcblxuZnVuY3Rpb24gZXh0cmFjdFV1aWQgKG9wdGlvbnMgPSB7fSwga2V5TmFtZXMgPSBbJ2VsZW1lbnQtNjA2Ni0xMWU0LWE1MmUtNGY3MzU0NjZjZWNmJywgJ2VsZW1lbnQnXSkge1xuICBmb3IgKGNvbnN0IG5hbWUgb2Yga2V5TmFtZXMpIHtcbiAgICBpZiAob3B0aW9uc1tuYW1lXSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdXRpbC51bndyYXBFbGVtZW50KG9wdGlvbnNbbmFtZV0pO1xuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gcmVxdWlyZVV1aWQgKG9wdGlvbnMgPSB7fSwga2V5TmFtZXMgPSBbJ2VsZW1lbnQtNjA2Ni0xMWU0LWE1MmUtNGY3MzU0NjZjZWNmJywgJ2VsZW1lbnQnXSkge1xuICBjb25zdCByZXN1bHQgPSBleHRyYWN0VXVpZChvcHRpb25zLCBrZXlOYW1lcyk7XG4gIGlmICghcmVzdWx0KSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5JbnZhbGlkQXJndW1lbnRFcnJvcihgJHtrZXlOYW1lc1swXX0gZmllbGQgaXMgbWFuZGF0b3J5YCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuY29tbWFuZHMuX2ZpbmRFbFJlY3QgPSBmdW5jdGlvbih1dWlkKSB7XG4gIGNvbnN0IHN0ckVsID0gdGhpcy5fY2FjaGUuZ2V0KHV1aWQpO1xuICBjb25zdCBkb2MgPSBuZXcgZG9tKCkucGFyc2VGcm9tU3RyaW5nKHN0ckVsKTtcbiAgaWYgKCFkb2MuYXR0cmlidXRlcykge1xuICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkVycm9yKFwidGhlIGVsZW1lbnQgaGFzIG5vIHJlY3QgYXR0cmlidXRlXCIpO1xuICB9XG4gIGNvbnN0IGF0dHJzID0gQXJyYXkuZnJvbShkb2MuYXR0cmlidXRlcyk7XG4gIGNvbnN0IHJlY3QgPSBhdHRycy5maW5kKHAgPT4gcC5uYW1lID0gJ3JlY3QnKT8udmFsdWU7XG4gIGlmICghcmVjdCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkVycm9yKFwidGhlIGVsZW1lbnQgaGFzIG5vIHJlY3QgYXR0cmlidXRlXCIpO1xuICB9XG4gIGNvbnN0IG1hdCA9IC9eXFxbKD88eD5cXGQrKVxcLCg/PHk+XFxkKylcXCwoPzx3aWR0aD5cXGQrKVxcLCg/PGhlaWdodD5cXGQrKVxcXSQvLmV4ZWMocmVjdClcbiAgaWYgKCFtYXQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVua25vd25FcnJvcihcInRoZSBlbGVtZW50J3MgcmVjdCBhdHRyaWJ1dGUgaXMgbWFsZm9ybWVkXCIpO1xuICB9XG4gIGNvbnN0IHt4LCB5LCB3aWR0aCwgaGVpZ2h0fSA9IG1hdC5ncm91cHM7XG4gIHJldHVybiB7XG4gICAgeDogTnVtYmVyLnBhcnNlSW50KHgpLFxuICAgIHk6IE51bWJlci5wYXJzZUludCh5KSxcbiAgICB3aWR0aDogTnVtYmVyLnBhcnNlSW50KHdpZHRoKSxcbiAgICBoZWlnaHQ6IE51bWJlci5wYXJzZUludChoZWlnaHQpXG4gIH07XG59O1xuXG5jb21tYW5kcy5zZXRWYWx1ZSA9IGNvbW1hbmRzLnJlcGxhY2VWYWx1ZSA9IGNvbW1hbmRzLnNldFZhbHVlSW1tZWRpYXRlID0gYXN5bmMgZnVuY3Rpb24gc2V0VmFsdWUgKG9wdHMgPSB7fSkge1xuICBjb25zdCB1dWlkID0gcmVxdWlyZVV1aWQob3B0cyk7XG4gIGNvbnN0IHsgdmFsdWUsIHRleHQgfSA9IG9wdHM7XG4gIGNvbnN0IF92ID0gdXRpbC5oYXNWYWx1ZSh2YWx1ZSk/IHZhbHVlOiB1dGlsLmhhc1ZhbHVlKHRleHQpPyB0ZXh0OiBudWxsO1xuICBjb25zdCB7eCwgeSwgd2lkdGgsIGhlaWdodH0gPSB0aGlzLl9maW5kRWxSZWN0KHV1aWQpO1xuICBjb25zdCBfeCA9IHggKyB3aWR0aCAvIDI7XG4gIGNvbnN0IF95ID0geSArIGhlaWdodCAvIDI7XG4gIGF3YWl0IHdhaXQ0c2VjKDAuNSk7XG4gIGFwaXMubW91c2VfY2xpY2soX3gsIF95LCAxKTtcbiAgYXdhaXQgd2FpdDRzZWMoMC41KTtcbiAgYXBpcy5rZXlib2FyZF90eXBlU3RyaW5nQ29weVBhc3RlKF92KTtcbiAgcmV0dXJuIG51bGw7XG59O1xuXG5jb21tYW5kcy5jbGljayA9IGFzeW5jIGZ1bmN0aW9uIGNsaWNrIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7IHgsIHksIGtleU1vZGlmaWVyRmxhZ3MgfSA9IG9wdHM7XG4gIHJldHVybiBudWxsO1xufTtcblxuY29tbWFuZHMuc2Nyb2xsID0gYXN5bmMgZnVuY3Rpb24gc2Nyb2xsIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7XG4gICAgeCwgeSxcbiAgICBkZWx0YVgsIGRlbHRhWSxcbiAgICBrZXlNb2RpZmllckZsYWdzLFxuICB9ID0gb3B0cztcbiAgcmV0dXJuIG51bGw7XG59O1xuXG5jb21tYW5kcy5zd2lwZSA9IGFzeW5jIGZ1bmN0aW9uIHN3aXBlIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7XG4gICAgeCwgeSxcbiAgICBkaXJlY3Rpb24sXG4gICAgdmVsb2NpdHksXG4gICAga2V5TW9kaWZpZXJGbGFncyxcbiAgfSA9IG9wdHM7XG4gIHJldHVybiBudWxsO1xufTtcblxuY29tbWFuZHMucmlnaHRDbGljayA9IGFzeW5jIGZ1bmN0aW9uIHJpZ2h0Q2xpY2sgKG9wdHMgPSB7fSkge1xuICBjb25zdCB1dWlkID0gZXh0cmFjdFV1aWQob3B0cyk7XG4gIGNvbnN0IHsgeCwgeSwga2V5TW9kaWZpZXJGbGFncyB9ID0gb3B0cztcbiAgcmV0dXJuIG51bGw7XG59O1xuXG5jb21tYW5kcy5ob3ZlciA9IGFzeW5jIGZ1bmN0aW9uIGhvdmVyIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7IHgsIHksIGtleU1vZGlmaWVyRmxhZ3MgfSA9IG9wdHM7XG4gIHJldHVybiBudWxsO1xufTtcblxuY29tbWFuZHMuZG91YmxlQ2xpY2sgPSBhc3luYyBmdW5jdGlvbiBkb3VibGVDbGljayAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHV1aWQgPSBleHRyYWN0VXVpZChvcHRzKTtcbiAgY29uc3QgeyB4LCB5LCBrZXlNb2RpZmllckZsYWdzIH0gPSBvcHRzO1xuICByZXR1cm4gbnVsbDtcbn07XG5cbmNvbW1hbmRzLmtleXMgPSBhc3luYyBmdW5jdGlvbiBrZXlzIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7IGtleXMgfSA9IG9wdHM7XG4gIHJldHVybiBudWxsO1xufTtcblxuY29tbWFuZHMucHJlc3NLZXlDb2RlID0gYXN5bmMgZnVuY3Rpb24gcHJlc3NLZXlDb2RlIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7IGtleWNvZGUsIGZsYWdzIH0gPSBvcHRzO1xuICByZXR1cm4gbnVsbDtcbn1cblxuY29tbWFuZHMubG9uZ1ByZXNzS2V5Q29kZSA9IGFzeW5jIGZ1bmN0aW9uIGxvbmdQcmVzc0tleUNvZGUgKG9wdHMgPSB7fSkge1xuICBjb25zdCB1dWlkID0gZXh0cmFjdFV1aWQob3B0cyk7XG4gIGNvbnN0IHsga2V5Y29kZSwgZmxhZ3MgfSA9IG9wdHM7XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjb21tYW5kcztcbiJdLCJmaWxlIjoibGliL2NvbW1hbmRzL2dlc3R1cmVzLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
